!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Log=void 0;const o={PO:n(1).PO};class r{constructor(e,t){this.converter=e,this.lines=t,this.curLine=t[0],this.curLineIdx=0}next(){return this.curLineIdx===this.lines.length-1?null:new r(this.converter,this.lines.slice(this.curLineIdx+1))}convert(){const e={};let t=this;const n=[];for(;null!==t;){const{params:o,fn:r}=this.converter.convertLine(t.curLine);let s;try{s=r(...this.converter.buildParams(e,t.clone(),o))}catch(e){throw new Error(`${e.message} at line: "${t.curLine}"`)}s&&n.push(...s),t=t.next()}return n}clone(){return new r(this.converter,this.lines.slice(this.curLineIdx))}}t.Log=r,"object"==typeof window&&(window.convert=function(e,t){return new r(o[e],t.split("\n")).convert().join("\n")})},function(e,t,n){"use strict";function o(e,t){const n={specie:e,name:t||e,hp:100};return n.nickname&&(n.nickname=t),n}function r(e,t){return{name:e,pNum:t,pokemon:{}}}function s(e){switch(e){case"Attack":return"atk";case"Defense":return"def";case"Sp. Att.":return"spa";case"Sp. Def.":return"spd";case"Speed":return"spe";default:throw new Error("Unrecognized stat: "+e)}}function a(e,t){t=null==t?void 0:t.trim();const[n,o]=[e.p1,e.p2];switch(t){case void 0:case""+n.name:case n.name+"'s":return[n,o];case"The foe's":case""+o.name:case o.name+"'s":return[o,n];default:throw new Error("Couldn't parse players in string: "+JSON.stringify(t))}}function i(e){if(e.includes("(")){const t=e.slice(e.lastIndexOf("(")+1,e.lastIndexOf(")"));return o(t,e.slice(0,-(t.length+4)))}return o(e.slice(0,e.endsWith("!")?-1:void 0))}function c(e,t){const n=[];for(const o of Object.values(e.p1.pokemon))o.name.toLowerCase()===t.toLowerCase()&&n.push({player:e.p1,pokemon:o});for(const o of Object.values(e.p2.pokemon))o.name.toLowerCase()===t.toLowerCase()&&n.push({player:e.p2,pokemon:o});if(!n.length)throw new Error("Could not parse owner for pokemon: "+JSON.stringify(t));return n.length>1?(e=>{var n;let o=null;for(const t of e){const{player:e,pokemon:r}=t;(null===(n=e.curPokemon)||void 0===n?void 0:n.name.toLowerCase())!==r.name.toLowerCase()&&(o={player:e,pokemon:r})}if(!o)throw new Error("Could not parse owner for pokemon: "+JSON.stringify(t));return o})(n):n[0]}function u(e,t,n){return"1"===e.pNum?n:t}Object.defineProperty(t,"__esModule",{value:!0}),t.PO=void 0;const p=["Bounce"],m={Protect:(e,t)=>[`|-singleturn|p${t.pNum}a: ${t.curPokemon.name}|protect`],"Perish Song":(e,t,n)=>["|-fieldactivate|move: Perish Song",`|-start|p1a: ${t.curPokemon.name}|perish3`,`|-start|p2a: ${n.curPokemon.name}|perish3`],"Mean Look":(e,t,n)=>[`|-activate|p${n.pNum}a: ${n.curPokemon.name}|trapped`]};t.PO={buildParams(e,t,n){var o,r,s;const c=[];for(const u of n)switch(u){case"context":c.push(e);break;case"missed":c.push(!!(null===(o=t.next())||void 0===o?void 0:o.curLine.match(/The attack of(.+'s )? missed/)));break;case"failed":c.push(!!(null===(r=t.next())||void 0===r?void 0:r.curLine.match(/But it failed!/)));break;case"nextMove":let n,u,p=t.next();for(;null!==p;){const t=null===(s=p.curLine.match(/(.+'s )?(.+) used .+!/))||void 0===s?void 0:s.slice(1);if(t){const[o,r]=t;n=a(e,o)[0],u=i(r),c.push({player:n,pokemon:u});break}p=p.next()}}return c},convertLine(e){var t,n,o,l,d,f,h,v,$,k,y,x,w,g,N,P,b,S,L,O,j,C,I,M,T,U,B,_,E,D,R,A,J,z,G,H,W;const V={params:[],fn:()=>{}};let Y=void 0;if(Y=null===(t=e.match(/Battle between (.+) and (.+) (started|is underway)!/))||void 0===t?void 0:t.slice(1),Y){const[e,t]=Y;return{params:["context"],fn:n=>(n.p1=r(e,"1"),n.p2=r(t,"2"),[`|player|p1|${n.p1.name}|1`,`|player|p2|${n.p2.name}|2`])}}if(Y=null===(n=e.match(/Mode: (.+)/))||void 0===n?void 0:n.slice(1),Y){const[e]=Y;return{params:[],fn:()=>["|gametype|"+e.toLowerCase()]}}if(Y=null===(o=e.match(/Rule: (.+)/))||void 0===o?void 0:o.slice(1),Y){const[e]=Y;return{params:[],fn:()=>["|rule|"+e]}}if(Y=null===(l=e.match(/Tier: (.+)/))||void 0===l?void 0:l.slice(1),Y){const[e]=Y,{tier:t,gen:n}=function(e){var t,n;const o={RBY:1,GSC:2,ADV:3,DPP:4,HGSS:4,DP:4,BW:5},r={tier:"OverUsed",gen:5},s={gen:null===(t=e.match(new RegExp(`(${Object.keys(o).join("|")}|\\d)`,"i")))||void 0===t?void 0:t.slice(1),tier:null===(n=e.match(new RegExp(`(${["OU","OverUsed","UU","UnderUsed","RU","RarelyUsed","NU","NeverUsed","LC","Little Cup"].join("|")})`,"i")))||void 0===n?void 0:n.slice(1)};if(s.gen){const[t]=s.gen;if(isNaN(parseInt(t))){const n=o[t.toUpperCase()];if(!n)throw new Error("Couldn't parse tier: "+JSON.stringify(e));r.gen=n}else r.gen=parseInt(t)}if(s.tier){const[e]=s.tier;r.tier=e}return r}(e);return{params:["context"],fn:e=>(e.gen=n,["|gen|"+n,`|tier|[Gen ${n}] ${t}`])}}if(Y=null===(d=e.match(/(.+): (.+)/))||void 0===d?void 0:d.slice(1),Y){const[e,t]=Y;return{params:["context"],fn:n=>[`|c|${[n.p1.name,n.p2.name].includes(e)?"â˜†":""}${e}|${t}`]}}if(Y=null===(f=e.match(/(.+) is watching the battle/))||void 0===f?void 0:f.slice(1),Y){const[e]=Y;return{params:[],fn:()=>["|j|"+e]}}if(Y=null===(h=e.match(/(.+) stopped watching the battle/))||void 0===h?void 0:h.slice(1),Y){const[e]=Y;return{params:[],fn:()=>["|l|"+e]}}if(Y=null===(v=e.match(/(.+) won the battle/))||void 0===v?void 0:v.slice(1),Y){const[e]=Y;return{params:[],fn:()=>["|win|"+e]}}if(Y=null===($=e.match(/(.+) forfeited against (.+)!/))||void 0===$?void 0:$.slice(1),Y){const[e,t]=Y;return{params:[],fn:()=>[`|-message|${e} forfeited`,"|","|win|"+t]}}if(Y=null===(k=e.match(/Start of turn (\d+)!?/))||void 0===k?void 0:k.slice(1),Y){const[e]=Y,t=parseInt(e);if(isNaN(t))throw new Error("Couldn't parse turn: "+JSON.stringify(e));return{params:["context"],fn:e=>{e.turn=t;const n=["|","|turn|"+t];return e.started||(e.started=!0,n.unshift("|start")),n}}}if(Y=null===(y=e.match(/(.+) sent out (.+)/))||void 0===y?void 0:y.slice(1),Y){const[e,t]=Y;return{params:["context"],fn:n=>{const o=i(t),[r]=a(n,e);r.pokemon[o.name]||(r.pokemon[o.name]=o),r.curPokemon=o,r.curPokemon.toxicTurns&&n.gen>2&&(r.curPokemon.toxicTurns=1);const s=[`|switch|p${r.pNum}a: ${o.name}|${o.specie}|${o.hp}/100${o.status?" "+o.status:""}`];return n.started||(n.started=!0,s.unshift("|start")),s}}}if(Y=null===(x=e.match(/(.+'s )?(.+) used (.+)!/))||void 0===x?void 0:x.slice(1),Y){const[e,t,n]=Y;return{params:["context","missed","failed","nextMove"],fn:(o,r,s,l)=>{const d=[],f=a(o,e)[0];if(!f.curPokemon){o.started||(o.started=!0,d.push("|start")),f.curPokemon=i(t),f.pokemon[f.curPokemon.name]=f.curPokemon,d.push(`|switch|p${f.pNum}a: ${f.curPokemon.name}|${f.curPokemon.name}|100`);const e=u(f,o.p1,o.p2);e.curPokemon=l.pokemon,e.pokemon[l.pokemon.name]=l.pokemon,d.push(`|switch|p${e.pNum}a: ${e.curPokemon.name}|${e.curPokemon.name}|100`)}const{player:h,pokemon:v}=c(o,t),$=u(h,o.p1,o.p2);return o.lastMoveBy=h,d.push(`|move|p${h.pNum}a: ${v.name}|${n}|p${$.pNum}a: ${h.curPokemon.name}`),r&&(d[0]+="|miss",d.push(`|-miss|p${h.pNum}a: ${v.name}`)),s&&d.push(`|-fail|p${h.pNum}a: ${v.name}|${n}`),p.includes(n)&&(d[0]+="|[from]lockedmove"),m[n]&&d.push(...m[n](o,h,$)),d}}}if(Y=null===(w=e.match(/(.+) lost \d+ HP! \((\d+)% of its health\)/))||void 0===w?void 0:w.slice(1),Y){const[e,t]=Y;return{params:["context"],fn:n=>{const{player:o,pokemon:r}=c(n,e);let s=r.hp-parseInt(t);return s<0&&(s=0),r.hp=s,[`|-damage|p${o.pNum}a: ${r.name}|${r.hp}/100${r.status?" "+r.status:""}`]}}}if(Y=null===(g=e.match(/(?:.+'s )?(.+) lost (\d+)% of its health!/))||void 0===g?void 0:g.slice(1),Y){const[e,t]=Y;return{params:["context"],fn:n=>{const{player:o,pokemon:r}=c(n,e);let s=r.hp-parseInt(t);return s<0&&(s=0),r.hp=s,[`|-damage|p${o.pNum}a: ${r.name}|${r.hp}/100${r.status?" "+r.status:""}`]}}}if(Y=null===(N=e.match(/(?:.+'s )?(.+) regained health!/))||void 0===N?void 0:N.slice(1),Y){const[e]=Y;return{params:["context"],fn:t=>{const{player:n,pokemon:o}=c(t,e);let r=o.hp+50;return r>100&&(r=100),o.hp=r,[`|-heal|p${n.pNum}a: ${o.name}|${o.hp}/100${o.status?" "+o.status:""}`]}}}if(Y=null===(P=e.match(/(?:.+'s )?(.+) fainted!/))||void 0===P?void 0:P.slice(1),Y){const[e]=Y;return{params:["context"],fn:t=>{const{player:n,pokemon:o}=c(t,e);return[`|faint|p${n.pNum}a: ${o.name}`]}}}if("It's super effective!"===e)return{params:["context"],fn:e=>{const t=u(e.lastMoveBy,e.p1,e.p2);return[`|-supereffective|p${t.pNum}a: ${t.curPokemon.name}`]}};if("It's not very effective..."===e)return{params:["context"],fn:e=>{const t=u(e.lastMoveBy,e.p1,e.p2);return[`|-resisted|p${t.pNum}a: ${t.curPokemon.name}`]}};if("A critical hit!"===e)return{params:["context"],fn:e=>{const t=u(e.lastMoveBy,e.p1,e.p2);return[`|-crit|p${t.pNum}a: ${t.curPokemon.name}`]}};if(Y=null===(b=e.match(/It had no effect on .+!/))||void 0===b?void 0:b.slice(1),Y)return{params:["context"],fn:e=>{const t=u(e.lastMoveBy,e.p1,e.p2);return[`|-immune|p${t.pNum}a: ${t.curPokemon.name}`]}};if(Y=null===(S=e.match(/(?:.+'s )?(.+) is paralyzed! It may be unable to move!/))||void 0===S?void 0:S.slice(1),Y){const[e]=Y;return{params:["context"],fn:t=>{const{player:n,pokemon:o}=c(t,e);return o.status="par",[`|-status|p${n.pNum}a: ${o.name}|par`]}}}if(Y=null===(L=e.match(/(?:.+'s )?(.+) is paralyzed! It can't move!/))||void 0===L?void 0:L.slice(1),Y){const[e]=Y;return{params:["context"],fn:t=>{const{player:n,pokemon:o}=c(t,e);return[`|cant|p${n.pNum}a: ${o.name}`]}}}if(Y=null===(O=e.match(/(?:.+'s )?(.+) fell asleep!/))||void 0===O?void 0:O.slice(1),Y){const[e]=Y;return{params:["context"],fn:t=>{const{player:n,pokemon:o}=c(t,e);return o.status="slp",[`|-status|p${n.pNum}a: ${o.name}|slp`]}}}if(Y=null===(j=e.match(/(?:.+'s )?(.+) is fast asleep!/))||void 0===j?void 0:j.slice(1),Y){const[e]=Y;return{params:["context"],fn:t=>{const{player:n,pokemon:o}=c(t,e);return[`|cant|p${n.pNum}a: ${o.name}`]}}}if(Y=null===(C=e.match(/(?:.+'s )?(.+) was (badly )?poisoned!/))||void 0===C?void 0:C.slice(1),Y){const[e,t]=Y;return{params:["context"],fn:n=>{const{player:o,pokemon:r}=c(n,e);return r.status=t?"psn":"tox","tox"===r.status&&(r.toxicTurns=1),[`|-status|p${o.pNum}a: ${r.name}|psn`]}}}if(Y=null===(I=e.match(/(?:.+'s )?(.+) was hurt by poison!/))||void 0===I?void 0:I.slice(1),Y){const[e]=Y;return{params:["context"],fn:t=>{const{player:n,pokemon:o}=c(t,e);let r;return r="tox"===o.status?6*o.toxicTurns++:1===t.gen?6:12,o.hp-=r,[`|-damage|p${n.pNum}a: ${o.name}|${o.hp}/100 tox|[from] ${o.status}`]}}}if(Y=null===(M=e.match(/(?:.+'s )?(.+) woke up!/))||void 0===M?void 0:M.slice(1),Y){const[e]=Y;return{params:["context"],fn:t=>{const{player:n,pokemon:o}=c(t,e);return o.status=void 0,[`|-curestatus|p${n.pNum}a: ${o.name}|slp`]}}}if(Y=null===(T=e.match(/(?:.+'s )?(.+) restored a little HP using its Leftovers!/))||void 0===T?void 0:T.slice(1),Y){const[e]=Y;return{params:["context"],fn:t=>{const{player:n,pokemon:o}=c(t,e);let r=o.hp+6;return r>100&&(r=100),o.hp=r,[`|-heal|p${n.pNum}a: ${o.name}|${o.hp}/100${o.status?" "+o.status:""}|[from] item: Leftovers`]}}}if(Y=null===(U=e.match(/(?:.+'s )?(.+)'s perish count fell to (\d)!/))||void 0===U?void 0:U.slice(1),Y){const[e,t]=Y;return{params:["context"],fn:n=>{const{player:o,pokemon:r}=c(n,e);return"3"===t?[]:[`|-start|p${o.pNum}a: ${r.name}|perish${t}`]}}}if(Y=null===(B=e.match(/(.+'s )?(.+) was dragged out!/))||void 0===B?void 0:B.slice(1),Y){const[e,t]=Y;return{params:["context"],fn:n=>{const o=i(t),[r]=a(n,e);return r.pokemon[o.name]||(r.pokemon[o.name]=o),r.curPokemon=o,r.curPokemon.toxicTurns&&n.gen>2&&(r.curPokemon.toxicTurns=1),[`|drag|p${r.pNum}a: ${o.name}|${o.specie}|${o.hp}/100${o.status?" "+o.status:""}`]}}}if(Y=null===(_=e.match(/(?:.+'s )?(.+) sprang up!/))||void 0===_?void 0:_.slice(1),Y){const[e]=Y;return{params:["context"],fn:t=>{const{player:n,pokemon:o}=c(t,e),r=u(n,t.p1,t.p2);return[`|move|p${n.pNum}a: ${o.name}|Bounce|[still]`,`|-prepare|p${n.pNum}a: ${o.name}|Bounce|p${r.pNum}a: ${r.curPokemon.name}`]}}}if(Y=null===(E=e.match(/(?:.+'s )?(.+) fell for the taunt!/))||void 0===E?void 0:E.slice(1),Y){const[e]=Y;return{params:["context"],fn:t=>{const{player:n,pokemon:o}=c(t,e);return[`|-start|p${n.pNum}a: ${o.name}|move: Taunt`]}}}if(Y=null===(D=e.match(/(?:.+'s )?(.+) can't use (.+) after the taunt!/))||void 0===D?void 0:D.slice(1),Y){const[e,t]=Y;return{params:["context"],fn:n=>{const{player:o,pokemon:r}=c(n,e);return[`|cant|p${o.pNum}a: ${r.name}|move: Taunt|${t}`]}}}if(Y=null===(R=e.match(/Spikes were scattered all around the feet of (.+)'s team!/))||void 0===R?void 0:R.slice(1),Y){const[e]=Y;return{params:["context"],fn:t=>{const n=a(t,e)[0];return[`|-sidestart|p${n.pNum}: ${n.name}|Spikes`]}}}if(Y=null===(A=e.match(/Pointed stones float in the air around (.+) team!/))||void 0===A?void 0:A.slice(1),Y){const[e]=Y;return{params:["context"],fn:t=>{const n=a(t,e)[0];return[`|-sidestart|p${n.pNum}: ${n.name}|Stealth Rock`]}}}if(Y=null===(J=e.match(/Poison Spikes were scattered all around the feet of (.+)'s team!/))||void 0===J?void 0:J.slice(1),Y){const[e]=Y;return{params:["context"],fn:t=>{const n=a(t,e)[0];return[`|-sidestart|p${n.pNum}: ${n.name}|Toxic Spikes`]}}}if(Y=null===(z=e.match(/(?:.+'s )?(.+) blew away (.+)!/))||void 0===z?void 0:z.slice(1),Y){const[e,t]=Y;return{params:["context"],fn:n=>{const{player:o}=c(n,e),r=u(o,n.p1,n.p2);return[`|-sideend|p${r.pNum}: ${r.name}|${t}`]}}}if(Y=null===(G=e.match(/(?:.+'s )?(.+)'s (Attack|Defense|Speed|Sp\. Att.|Sp\. Def\.) (sharply )?(rose|fell)!/))||void 0===G?void 0:G.slice(1),Y){const[e,t,n,o]=Y;return{params:["context"],fn:r=>{const{player:a,pokemon:i}=c(r,e);return[`|-${"fell"===o?"un":""}boost|p${a.pNum}a: ${i.name}|${s(t)}|${n?"2":"1"}`]}}}if(Y=null===(H=e.match(/(?:.+'s )?(.+)'s Sand Stream whipped up a sandstorm!/))||void 0===H?void 0:H.slice(1),Y){const[e]=Y;return{params:["context"],fn:t=>{const{player:n,pokemon:o}=c(t,e);return[`|-weather|Sandstorm|[from] ability: Sand Stream|[of] p${n.pNum}a: ${o.name}`]}}}if("The sandstorm rages."===e)return{params:[],fn:()=>["|-weather|Sandstorm|[upkeep]"]};if(Y=null===(W=e.match(/(?:.+'s )?(.+) is buffeted by the sandstorm!/))||void 0===W?void 0:W.slice(1),Y){const[e]=Y;return{params:["context"],fn:t=>{const{player:n,pokemon:o}=c(t,e);let r=o.hp-6;return r<0&&(r=0),o.hp=r,[`|-damage|p${n.pNum}a: ${o.name}|${o.hp}/100${o.status?" "+o.status:""}|[from] Sandstorm`]}}}return V}}}]);